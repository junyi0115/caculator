pipeline {
	agent any
	stages{
		stage('checkout') {
            steps {
                echo 'check out'
                git url: 'https://github.com/junyi0115/caculator.git', branch: 'main'
            }
        }
		stage("Compile") {
			steps {
				sh "chmod +x ./gradlew"
				sh "./gradlew compileJava"
			}
		}
		stage("Unit Test") {
            steps {
                sh "./gradlew test"
            }
        }
        stage("Code coverage") {
            steps {
                sh "./gradlew test jacocoTestReport"
                publishHTML(target:[
					reportDir: 'build/reports/jacoco/test/html',
					reportFiles: 'index.html',
					reportName: 'Jacoco Report'
				])
                sh "./gradlew test jacocoTestCoverageVerification"
            }
        }
	}
}